"use strict";(()=>{(function(){let o="[rybbit-ad]",i="d38451f43f87",a=document.currentScript;if(!a){console.warn(o,"Could not find script tag");return}let d=(a.getAttribute("src")||"").split("/frog.js")[0].replace("/api",""),g=d+"/api/track";console.log(o,"Initialized",{siteId:i,analyticsHost:d});function l(n,t){return{type:n,site_id:i,pathname:t,hostname:window.location.hostname,screenWidth:window.screen.width,screenHeight:window.screen.height,language:navigator.language,page_title:document.title,referrer:document.referrer}}function u(n){console.log(o,"Sending payload",n),fetch(g,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n),keepalive:!0}).then(t=>t.ok?console.log(o,"Tracked OK",t.status):t.text().then(e=>console.error(o,"Track failed",t.status,e))).catch(t=>console.error(o,"fetch error:",t))}document.addEventListener("click",function(n){let e=n.target.closest('img[alt="ad"]');if(!e)return;let s=e.src;if(!s)return;let h=e.closest("a");console.log(o,"Ad click detected",{imgSrc:s,href:h?.href}),u(l("ad_click",s))});let r=new WeakSet,c=new IntersectionObserver(n=>{for(let t of n)if(t.isIntersecting){let e=t.target,s=e.src;s&&(console.log(o,"Ad impression detected",{imgSrc:s}),u(l("ad_impression",s))),c.unobserve(e)}},{threshold:.5});function m(n=document){n.querySelectorAll('img[alt="ad"]').forEach(e=>{r.has(e)||(r.add(e),c.observe(e))})}m();let f=new MutationObserver(n=>{for(let t of n)for(let e of t.addedNodes)e instanceof HTMLElement&&(e.matches('img[alt="ad"]')?r.has(e)||(r.add(e),c.observe(e)):m(e))});f.observe(document.body,{childList:!0,subtree:!0}),window.addEventListener("unload",()=>{c.disconnect(),f.disconnect()})})();})();
