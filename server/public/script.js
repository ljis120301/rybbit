"use strict";(()=>{var Ie=Object.defineProperty;var Ae=(r,e,t)=>e in r?Ie(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var f=(r,e,t)=>Ae(r,typeof e!="symbol"?e+"":e,t);function Be(r){let e="__DOUBLE_ASTERISK_TOKEN__",t="__SINGLE_ASTERISK_TOKEN__",n=r.replace(/\*\*/g,e).replace(/\*/g,t).replace(/[.+?^${}()|[\]\\]/g,"\\$&");n=n.replace(new RegExp(`/${e}/`,"g"),"/(?:.+/)?"),n=n.replace(new RegExp(e,"g"),".*"),n=n.replace(/\//g,"\\/");let a=n.replace(new RegExp(t,"g"),"[^/]+");return new RegExp("^"+a+"$")}function x(r,e){for(let t of e)try{if(Be(t).test(r))return t}catch(i){console.error(`Invalid pattern: ${t}`,i)}return null}function ee(r,e){let t=null;return(...i)=>{t&&clearTimeout(t),t=setTimeout(()=>r(...i),e)}}function te(r){try{let e=window.location.hostname,t=new URL(r).hostname;return t!==e&&t!==""}catch{return!1}}function m(r,e){if(!r)return e;try{let t=JSON.parse(r);return Array.isArray(e)&&!Array.isArray(t)?e:t}catch(t){return console.error("Error parsing JSON:",t),e}}async function re(r){let e=r.getAttribute("src");if(!e)return console.error("Script src attribute is missing"),null;let t=e.split("/script.js")[0];if(!t)return console.error("Please provide a valid analytics host"),null;let i=r.getAttribute("data-site-id")||r.getAttribute("site-id");if(!i)return console.error("Please provide a valid site ID using the data-site-id attribute"),null;let n=r.getAttribute("data-namespace")||"rybbit",a=m(r.getAttribute("data-skip-patterns"),[]),l=m(r.getAttribute("data-mask-patterns"),[]),c=m(r.getAttribute("data-replay-mask-text-selectors"),[]),s=r.getAttribute("data-debounce")?Math.max(0,parseInt(r.getAttribute("data-debounce"))):500,o=r.getAttribute("data-replay-batch-size")?Math.max(1,parseInt(r.getAttribute("data-replay-batch-size"))):250,d=r.getAttribute("data-replay-batch-interval")?Math.max(1e3,parseInt(r.getAttribute("data-replay-batch-interval"))):5e3,S=r.getAttribute("data-replay-block-class")||void 0,b=r.getAttribute("data-replay-block-selector")||void 0,M=r.getAttribute("data-replay-ignore-class")||void 0,ke=r.getAttribute("data-replay-ignore-selector")||void 0,Re=r.getAttribute("data-replay-mask-text-class")||void 0,K=r.getAttribute("data-replay-mask-all-inputs"),Se=K!==null?K!=="false":void 0,q=r.getAttribute("data-replay-mask-input-options"),we=q?m(q,{password:!0,email:!0}):void 0,G=r.getAttribute("data-replay-collect-fonts"),Te=G!==null?G!=="false":void 0,Q=r.getAttribute("data-replay-sampling"),Ce=Q?m(Q,{}):void 0,Y=r.getAttribute("data-replay-slim-dom-options"),Ee=Y?m(Y,{}):void 0,X=r.getAttribute("data-replay-sample-rate"),Pe=X?Math.min(100,Math.max(0,parseInt(X,10))):void 0,u={namespace:n,analyticsHost:t,siteId:i,debounceDuration:s,sessionReplayBatchSize:o,sessionReplayBatchInterval:d,sessionReplayMaskTextSelectors:c,skipPatterns:a,maskPatterns:l,autoTrackPageview:!0,autoTrackSpa:!0,trackQuerystring:!0,trackOutbound:!0,enableWebVitals:!1,trackErrors:!1,enableSessionReplay:!1,trackButtonClicks:!1,trackCopy:!1,sessionReplayBlockClass:S,sessionReplayBlockSelector:b,sessionReplayIgnoreClass:M,sessionReplayIgnoreSelector:ke,sessionReplayMaskTextClass:Re,sessionReplayMaskAllInputs:Se,sessionReplayMaskInputOptions:we,sessionReplayCollectFonts:Te,sessionReplaySampling:Ce,sessionReplaySlimDOMOptions:Ee,sessionReplaySampleRate:Pe};try{let L=`${t}/site/tracking-config/${i}`,Z=await fetch(L,{method:"GET",credentials:"omit"});if(Z.ok){let g=await Z.json();return{...u,autoTrackPageview:g.trackInitialPageView??u.autoTrackPageview,autoTrackSpa:g.trackSpaNavigation??u.autoTrackSpa,trackQuerystring:g.trackUrlParams??u.trackQuerystring,trackOutbound:g.trackOutbound??u.trackOutbound,enableWebVitals:g.webVitals??u.enableWebVitals,trackErrors:g.trackErrors??u.trackErrors,enableSessionReplay:g.sessionReplay??u.enableSessionReplay,trackButtonClicks:g.trackButtonClicks??u.trackButtonClicks,trackCopy:g.trackCopy??u.trackCopy}}else return console.warn("Failed to fetch tracking config from API, using defaults"),u}catch(L){return console.warn("Error fetching tracking config:",L),u}}var ie="rybbit-replay-sampled";function Me(r){if(r>=100)return!0;if(r<=0)return!1;try{let e=sessionStorage.getItem(ie);if(e!==null)return e==="1";let t=Math.random()*100<r;return sessionStorage.setItem(ie,t?"1":"0"),t}catch{return Math.random()*100<r}}var w=class{constructor(e,t,i){this.isRecording=!1;this.eventBuffer=[];this.config=e,this.userId=t,this.sendBatch=i}async initialize(){if(!this.config.enableSessionReplay)return;let e=this.config.sessionReplaySampleRate;e!==void 0&&!Me(e)||(window.rrweb||await this.loadRrweb(),window.rrweb&&this.startRecording())}async loadRrweb(){return new Promise((e,t)=>{let i=document.createElement("script");i.src=`${this.config.analyticsHost}/replay.js`,i.async=!1,i.onload=()=>{e()},i.onerror=()=>t(new Error("Failed to load rrweb")),document.head.appendChild(i)})}startRecording(){if(!(this.isRecording||!window.rrweb||!this.config.enableSessionReplay))try{let e={mousemove:!1,mouseInteraction:{MouseUp:!1,MouseDown:!1,Click:!0,ContextMenu:!1,DblClick:!0,Focus:!0,Blur:!0,TouchStart:!1,TouchEnd:!1},scroll:500,input:"last",media:800},t={script:!1,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0},i={emit:n=>{this.addEvent({type:n.type,data:n.data,timestamp:n.timestamp||Date.now()})},recordCanvas:!1,checkoutEveryNms:6e4,checkoutEveryNth:500,blockClass:this.config.sessionReplayBlockClass??"rr-block",blockSelector:this.config.sessionReplayBlockSelector??null,ignoreClass:this.config.sessionReplayIgnoreClass??"rr-ignore",ignoreSelector:this.config.sessionReplayIgnoreSelector??null,maskTextClass:this.config.sessionReplayMaskTextClass??"rr-mask",maskAllInputs:this.config.sessionReplayMaskAllInputs??!0,maskInputOptions:this.config.sessionReplayMaskInputOptions??{password:!0,email:!0},collectFonts:this.config.sessionReplayCollectFonts??!0,sampling:this.config.sessionReplaySampling??e,slimDOMOptions:this.config.sessionReplaySlimDOMOptions??t};this.config.sessionReplayMaskTextSelectors&&this.config.sessionReplayMaskTextSelectors.length>0&&(i.maskTextSelector=this.config.sessionReplayMaskTextSelectors.join(", ")),this.stopRecordingFn=window.rrweb.record(i),this.isRecording=!0,this.setupBatchTimer()}catch{}}stopRecording(){this.isRecording&&(this.stopRecordingFn&&this.stopRecordingFn(),this.isRecording=!1,this.clearBatchTimer(),this.eventBuffer.length>0&&this.flushEvents())}isActive(){return this.isRecording}addEvent(e){this.eventBuffer.push(e),this.eventBuffer.length>=this.config.sessionReplayBatchSize&&this.flushEvents()}setupBatchTimer(){this.clearBatchTimer(),this.batchTimer=window.setInterval(()=>{this.eventBuffer.length>0&&this.flushEvents()},this.config.sessionReplayBatchInterval)}clearBatchTimer(){this.batchTimer&&(clearInterval(this.batchTimer),this.batchTimer=void 0)}async flushEvents(){if(this.eventBuffer.length===0)return;let e=[...this.eventBuffer];this.eventBuffer=[];let t={userId:this.userId,events:e,metadata:{pageUrl:window.location.href,viewportWidth:screen.width,viewportHeight:screen.height,language:navigator.language}};try{await this.sendBatch(t)}catch{this.eventBuffer.unshift(...e)}}updateUserId(e){this.userId=e}onPageChange(){this.isRecording&&this.flushEvents()}cleanup(){this.stopRecording()}};var T=class{constructor(e){this.customUserId=null;this.config=e,this.loadUserId(),e.enableSessionReplay&&this.initializeSessionReplay()}loadUserId(){try{let e=localStorage.getItem(`${this.config.namespace}-user-id`);e&&(this.customUserId=e)}catch{}}async initializeSessionReplay(){try{this.sessionReplayRecorder=new w(this.config,this.customUserId||"",e=>this.sendSessionReplayBatch(e)),await this.sessionReplayRecorder.initialize()}catch(e){console.error("Failed to initialize session replay:",e)}}async sendSessionReplayBatch(e){try{await fetch(`${this.config.analyticsHost}/session-replay/record/${this.config.siteId}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),mode:"cors",keepalive:!1})}catch(t){throw console.error("Failed to send session replay batch:",t),t}}createBasePayload(){let e=new URL(window.location.href),t=e.pathname;if(e.hash&&e.hash.startsWith("#/")&&(t=e.hash.substring(1)),x(t,this.config.skipPatterns))return null;let i=x(t,this.config.maskPatterns);i&&(t=i);let n={site_id:this.config.siteId,hostname:e.hostname,pathname:t,querystring:this.config.trackQuerystring?e.search:"",screenWidth:screen.width,screenHeight:screen.height,language:navigator.language,page_title:document.title,referrer:document.referrer};return this.customUserId&&(n.user_id=this.customUserId),n}async sendTrackingData(e){try{await fetch(`${this.config.analyticsHost}/track`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),mode:"cors",keepalive:!0})}catch(t){console.error("Failed to send tracking data:",t)}}track(e,t="",i={}){if(e==="custom_event"&&(!t||typeof t!="string")){console.error("Event name is required and must be a string for custom events");return}let n=this.createBasePayload();if(!n)return;let l={...n,type:e,event_name:t,properties:["custom_event","outbound","error","button_click","copy"].includes(e)?JSON.stringify(i):void 0};this.sendTrackingData(l)}trackPageview(){this.track("pageview")}trackEvent(e,t={}){this.track("custom_event",e,t)}trackOutbound(e,t="",i="_self"){this.track("outbound","",{url:e,text:t,target:i})}trackWebVitals(e){let t=this.createBasePayload();if(!t)return;let i={...t,type:"performance",event_name:"web-vitals",...e};this.sendTrackingData(i)}trackError(e,t={}){let i=window.location.origin,n=t.filename||"",a=e.stack||"";if(n)try{if(new URL(n).origin!==i)return}catch{}else if(a&&!a.includes(i))return;let l={message:e.message?.substring(0,500)||"Unknown error",stack:a.substring(0,2e3)||""};if(n&&(l.fileName=n),t.lineno){let c=typeof t.lineno=="string"?parseInt(t.lineno,10):t.lineno;c&&c!==0&&(l.lineNumber=c)}if(t.colno){let c=typeof t.colno=="string"?parseInt(t.colno,10):t.colno;c&&c!==0&&(l.columnNumber=c)}for(let c in t)!["lineno","colno"].includes(c)&&t[c]!==void 0&&(l[c]=t[c]);this.track("error",e.name||"Error",l)}trackButtonClick(e){this.track("button_click","",e)}trackCopy(e){this.track("copy","",e)}identify(e,t){if(typeof e!="string"||e.trim()===""){console.error("User ID must be a non-empty string");return}this.customUserId=e.trim();try{localStorage.setItem(`${this.config.namespace}-user-id`,this.customUserId)}catch{console.warn("Could not persist user ID to localStorage")}this.sendIdentifyEvent(this.customUserId,t,!0),this.sessionReplayRecorder&&this.sessionReplayRecorder.updateUserId(this.customUserId)}setTraits(e){if(!e||typeof e!="object"){console.error("Traits must be an object");return}let t=this.customUserId;if(!t){console.warn("Cannot set traits without identifying user first. Call identify() first.");return}this.sendIdentifyEvent(t,e,!1)}async sendIdentifyEvent(e,t,i=!0){try{await fetch(`${this.config.analyticsHost}/identify`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({site_id:this.config.siteId,user_id:e,traits:t,is_new_identify:i}),mode:"cors",keepalive:!0})}catch(n){console.error("Failed to send identify event:",n)}}clearUserId(){this.customUserId=null;try{localStorage.removeItem(`${this.config.namespace}-user-id`)}catch{}}getUserId(){return this.customUserId}startSessionReplay(){this.sessionReplayRecorder?this.sessionReplayRecorder.startRecording():console.warn("Session replay not initialized")}stopSessionReplay(){this.sessionReplayRecorder&&this.sessionReplayRecorder.stopRecording()}isSessionReplayActive(){return this.sessionReplayRecorder?.isActive()??!1}onPageChange(){this.sessionReplayRecorder&&this.sessionReplayRecorder.onPageChange()}cleanup(){this.sessionReplayRecorder&&this.sessionReplayRecorder.cleanup()}};var pe=-1,v=r=>{addEventListener("pageshow",(e=>{e.persisted&&(pe=e.timeStamp,r(e))}),!0)},p=(r,e,t,i)=>{let n,a;return l=>{e.value>=0&&(l||i)&&(a=e.value-(n??0),(a||n===void 0)&&(n=e.value,e.delta=a,e.rating=((c,s)=>c>s[1]?"poor":c>s[0]?"needs-improvement":"good")(e.value,t),r(e)))}},V=r=>{requestAnimationFrame((()=>requestAnimationFrame((()=>r()))))},z=()=>{let r=performance.getEntriesByType("navigation")[0];if(r&&r.responseStart>0&&r.responseStart<performance.now())return r},k=()=>z()?.activationStart??0,h=(r,e=-1)=>{let t=z(),i="navigate";return pe>=0?i="back-forward-cache":t&&(document.prerendering||k()>0?i="prerender":document.wasDiscarded?i="restore":t.type&&(i=t.type.replace(/_/g,"-"))),{name:r,value:e,rating:"good",delta:0,entries:[],id:`v5-${Date.now()}-${Math.floor(8999999999999*Math.random())+1e12}`,navigationType:i}},O=new WeakMap;function $(r,e){return O.get(r)||O.set(r,new e),O.get(r)}var U=class{constructor(){f(this,"t");f(this,"i",0);f(this,"o",[])}h(e){if(e.hadRecentInput)return;let t=this.o[0],i=this.o.at(-1);this.i&&t&&i&&e.startTime-i.startTime<1e3&&e.startTime-t.startTime<5e3?(this.i+=e.value,this.o.push(e)):(this.i=e.value,this.o=[e]),this.t?.(e)}},R=(r,e,t={})=>{try{if(PerformanceObserver.supportedEntryTypes.includes(r)){let i=new PerformanceObserver((n=>{Promise.resolve().then((()=>{e(n.getEntries())}))}));return i.observe({type:r,buffered:!0,...t}),i}}catch{}},j=r=>{let e=!1;return()=>{e||(r(),e=!0)}},y=-1,he=new Set,ne=()=>document.visibilityState!=="hidden"||document.prerendering?1/0:0,N=r=>{if(document.visibilityState==="hidden"){if(r.type==="visibilitychange")for(let e of he)e();isFinite(y)||(y=r.type==="visibilitychange"?r.timeStamp:0,removeEventListener("prerenderingchange",N,!0))}},E=()=>{if(y<0){let r=k();y=(document.prerendering?void 0:globalThis.performance.getEntriesByType("visibility-state").filter((t=>t.name==="hidden"&&t.startTime>r))[0]?.startTime)??ne(),addEventListener("visibilitychange",N,!0),addEventListener("prerenderingchange",N,!0),v((()=>{setTimeout((()=>{y=ne()}))}))}return{get firstHiddenTime(){return y},onHidden(r){he.add(r)}}},P=r=>{document.prerendering?addEventListener("prerenderingchange",(()=>r()),!0):r()},se=[1800,3e3],J=(r,e={})=>{P((()=>{let t=E(),i,n=h("FCP"),a=R("paint",(l=>{for(let c of l)c.name==="first-contentful-paint"&&(a.disconnect(),c.startTime<t.firstHiddenTime&&(n.value=Math.max(c.startTime-k(),0),n.entries.push(c),i(!0)))}));a&&(i=p(r,n,se,e.reportAllChanges),v((l=>{n=h("FCP"),i=p(r,n,se,e.reportAllChanges),V((()=>{n.value=performance.now()-l.timeStamp,i(!0)}))})))}))},oe=[.1,.25],ge=(r,e={})=>{let t=E();J(j((()=>{let i,n=h("CLS",0),a=$(e,U),l=s=>{for(let o of s)a.h(o);a.i>n.value&&(n.value=a.i,n.entries=a.o,i())},c=R("layout-shift",l);c&&(i=p(r,n,oe,e.reportAllChanges),t.onHidden((()=>{l(c.takeRecords()),i(!0)})),v((()=>{a.i=0,n=h("CLS",0),i=p(r,n,oe,e.reportAllChanges),V((()=>i()))})),setTimeout(i))})))},fe=0,_=1/0,C=0,Le=r=>{for(let e of r)e.interactionId&&(_=Math.min(_,e.interactionId),C=Math.max(C,e.interactionId),fe=C?(C-_)/7+1:0)},D,ae=()=>D?fe:performance.interactionCount??0,xe=()=>{"interactionCount"in performance||D||(D=R("event",Le,{type:"event",buffered:!0,durationThreshold:0}))},ce=0,H=class{constructor(){f(this,"u",[]);f(this,"l",new Map);f(this,"m");f(this,"p")}v(){ce=ae(),this.u.length=0,this.l.clear()}L(){let e=Math.min(this.u.length-1,Math.floor((ae()-ce)/50));return this.u[e]}h(e){if(this.m?.(e),!e.interactionId&&e.entryType!=="first-input")return;let t=this.u.at(-1),i=this.l.get(e.interactionId);if(i||this.u.length<10||e.duration>t.P){if(i?e.duration>i.P?(i.entries=[e],i.P=e.duration):e.duration===i.P&&e.startTime===i.entries[0].startTime&&i.entries.push(e):(i={id:e.interactionId,entries:[e],P:e.duration},this.l.set(i.id,i),this.u.push(i)),this.u.sort(((n,a)=>a.P-n.P)),this.u.length>10){let n=this.u.splice(10);for(let a of n)this.l.delete(a.id)}this.p?.(i)}}},me=r=>{let e=globalThis.requestIdleCallback||setTimeout;document.visibilityState==="hidden"?r():(r=j(r),addEventListener("visibilitychange",r,{once:!0,capture:!0}),e((()=>{r(),removeEventListener("visibilitychange",r,{capture:!0})})))},le=[200,500],ye=(r,e={})=>{if(!globalThis.PerformanceEventTiming||!("interactionId"in PerformanceEventTiming.prototype))return;let t=E();P((()=>{xe();let i,n=h("INP"),a=$(e,H),l=s=>{me((()=>{for(let d of s)a.h(d);let o=a.L();o&&o.P!==n.value&&(n.value=o.P,n.entries=o.entries,i())}))},c=R("event",l,{durationThreshold:e.durationThreshold??40});i=p(r,n,le,e.reportAllChanges),c&&(c.observe({type:"first-input",buffered:!0}),t.onHidden((()=>{l(c.takeRecords()),i(!0)})),v((()=>{a.v(),n=h("INP"),i=p(r,n,le,e.reportAllChanges)})))}))},F=class{constructor(){f(this,"m")}h(e){this.m?.(e)}},de=[2500,4e3],ve=(r,e={})=>{P((()=>{let t=E(),i,n=h("LCP"),a=$(e,F),l=s=>{e.reportAllChanges||(s=s.slice(-1));for(let o of s)a.h(o),o.startTime<t.firstHiddenTime&&(n.value=Math.max(o.startTime-k(),0),n.entries=[o],i())},c=R("largest-contentful-paint",l);if(c){i=p(r,n,de,e.reportAllChanges);let s=j((()=>{l(c.takeRecords()),c.disconnect(),i(!0)})),o=d=>{d.isTrusted&&(me(s),removeEventListener(d.type,o,{capture:!0}))};for(let d of["keydown","click","visibilitychange"])addEventListener(d,o,{capture:!0});v((d=>{n=h("LCP"),i=p(r,n,de,e.reportAllChanges),V((()=>{n.value=performance.now()-d.timeStamp,i(!0)}))}))}}))},ue=[800,1800],W=r=>{document.prerendering?P((()=>W(r))):document.readyState!=="complete"?addEventListener("load",(()=>W(r)),!0):setTimeout(r)},be=(r,e={})=>{let t=h("TTFB"),i=p(r,t,ue,e.reportAllChanges);W((()=>{let n=z();n&&(t.value=Math.max(n.responseStart-k(),0),t.entries=[n],i(!0),v((()=>{t=h("TTFB",0),i=p(r,t,ue,e.reportAllChanges),i(!0)})))}))};var I=class{constructor(e){this.data={lcp:null,cls:null,inp:null,fcp:null,ttfb:null};this.sent=!1;this.timeout=null;this.onReadyCallback=null;this.onReadyCallback=e}initialize(){try{ve(this.collectMetric.bind(this)),ge(this.collectMetric.bind(this)),ye(this.collectMetric.bind(this)),J(this.collectMetric.bind(this)),be(this.collectMetric.bind(this)),this.timeout=setTimeout(()=>{this.sent||this.sendData()},2e4),window.addEventListener("beforeunload",()=>{this.sent||this.sendData()})}catch(e){console.warn("Error initializing web vitals tracking:",e)}}collectMetric(e){if(this.sent)return;let t=e.name.toLowerCase();this.data[t]=e.value,Object.values(this.data).every(n=>n!==null)&&this.sendData()}sendData(){this.sent||(this.sent=!0,this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.onReadyCallback&&this.onReadyCallback(this.data))}getData(){return{...this.data}}};var A=class{constructor(e,t){this.tracker=e,this.config=t}initialize(){document.addEventListener("click",this.handleClick.bind(this),!0)}handleClick(e){let t=e.target;this.config.trackButtonClicks&&this.isButton(t)&&this.trackButtonClick(t)}isButton(e){if(e.tagName==="BUTTON"||e.getAttribute("role")==="button")return!0;if(e.tagName==="INPUT"){let n=e.type?.toLowerCase();if(n==="submit"||n==="button")return!0}let t=e.parentElement,i=0;for(;t&&i<3;){if(t.tagName==="BUTTON"||t.getAttribute("role")==="button")return!0;t=t.parentElement,i++}return!1}trackButtonClick(e){let t=this.findButton(e);if(!t)return;let i={element:t.tagName.toLowerCase(),text:this.getElementText(t)};this.tracker.trackButtonClick(i)}findButton(e){if(e.tagName==="BUTTON"||e.getAttribute("role")==="button")return e;if(e.tagName==="INPUT"){let n=e.type?.toLowerCase();if(n==="submit"||n==="button")return e}let t=e.parentElement,i=0;for(;t&&i<3;){if(t.tagName==="BUTTON"||t.getAttribute("role")==="button")return t;t=t.parentElement,i++}return null}getElementText(e){return e.textContent?.trim().substring(0,100)||void 0}cleanup(){document.removeEventListener("click",this.handleClick.bind(this),!0)}};var B=class{constructor(e){this.tracker=e}initialize(){document.addEventListener("copy",this.handleCopy.bind(this))}handleCopy(){let e=window.getSelection();if(!e||e.isCollapsed)return;let i=e.toString().length;if(i===0)return;let n=e.anchorNode,a=n instanceof HTMLElement?n:n?.parentElement;if(!a)return;let l={textLength:i,sourceElement:a.tagName.toLowerCase()};this.tracker.trackCopy(l)}cleanup(){document.removeEventListener("copy",this.handleCopy.bind(this))}};(async function(){let r=document.currentScript;if(!r){console.error("Could not find current script tag");return}let e=r.getAttribute("data-namespace")||"rybbit",t=`disable-${e}`;if(window.__RYBBIT_OPTOUT__||localStorage.getItem(t)!==null){window[e]={pageview:()=>{},event:()=>{},error:()=>{},trackOutbound:()=>{},identify:()=>{},setTraits:()=>{},clearUserId:()=>{},getUserId:()=>null,startSessionReplay:()=>{},stopSessionReplay:()=>{},isSessionReplayActive:()=>!1};return}let i=await re(r);if(!i)return;let n=new T(i);i.enableWebVitals&&new I(o=>{n.trackWebVitals(o)}).initialize(),i.trackButtonClicks&&new A(n,i).initialize(),i.trackCopy&&new B(n).initialize(),i.trackErrors&&(window.addEventListener("error",s=>{n.trackError(s.error||new Error(s.message),{filename:s.filename,lineno:s.lineno,colno:s.colno})}),window.addEventListener("unhandledrejection",s=>{let o=s.reason instanceof Error?s.reason:new Error(String(s.reason));n.trackError(o,{type:"unhandledrejection"})}));let a=()=>n.trackPageview(),l=i.debounceDuration>0?ee(a,i.debounceDuration):a;function c(){if(document.addEventListener("click",function(s){let o=s.target;for(;o&&o!==document.documentElement;){if(o.hasAttribute("data-rybbit-event")){let d=o.getAttribute("data-rybbit-event");if(d){let S={};for(let b of o.attributes)if(b.name.startsWith("data-rybbit-prop-")){let M=b.name.replace("data-rybbit-prop-","");S[M]=b.value}n.trackEvent(d,S)}break}o=o.parentElement}if(i.trackOutbound){let d=s.target.closest("a");d?.href&&te(d.href)&&n.trackOutbound(d.href,d.innerText||d.textContent||"",d.target||"_self")}}),i.autoTrackSpa){let s=history.pushState,o=history.replaceState;history.pushState=function(...d){s.apply(this,d),l(),n.onPageChange()},history.replaceState=function(...d){o.apply(this,d),l(),n.onPageChange()},window.addEventListener("popstate",()=>{l(),n.onPageChange()}),window.addEventListener("hashchange",()=>{l(),n.onPageChange()})}}window[i.namespace]={pageview:()=>n.trackPageview(),event:(s,o={})=>n.trackEvent(s,o),error:(s,o={})=>n.trackError(s,o),trackOutbound:(s,o="",d="_self")=>n.trackOutbound(s,o,d),identify:(s,o)=>n.identify(s,o),setTraits:s=>n.setTraits(s),clearUserId:()=>n.clearUserId(),getUserId:()=>n.getUserId(),startSessionReplay:()=>n.startSessionReplay(),stopSessionReplay:()=>n.stopSessionReplay(),isSessionReplayActive:()=>n.isSessionReplayActive()},c(),window.addEventListener("beforeunload",()=>{n.cleanup()}),i.autoTrackPageview&&n.trackPageview()})();})();
